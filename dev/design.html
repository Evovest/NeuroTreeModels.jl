<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>NeuroTree - A differentiable tree operator for tabular data | NeuroTreeModels</title>
    <meta name="description" content="Docs for NeuroTreeModels.jl">
    <meta name="generator" content="VitePress v1.2.3">
    <link rel="preload stylesheet" href="/NeuroTreeModels.jl/dev/assets/style.BOKMqh84.css" as="style">
    
    <script type="module" src="/NeuroTreeModels.jl/dev/assets/app.CmezxF5o.js"></script>
    <link rel="preload" href="/NeuroTreeModels.jl/dev/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/NeuroTreeModels.jl/dev/assets/chunks/framework.B9gXQuHl.js">
    <link rel="modulepreload" href="/NeuroTreeModels.jl/dev/assets/chunks/theme.v1VXVyEp.js">
    <link rel="modulepreload" href="/NeuroTreeModels.jl/dev/assets/design.md.Ce2HVKVG.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar has-sidebar top" data-v-f1e365da data-v-40788ea0><div class="wrapper" data-v-40788ea0><div class="container" data-v-40788ea0><div class="title" data-v-40788ea0><div class="VPNavBarTitle has-sidebar" data-v-40788ea0 data-v-28a961f9><a class="title" href="/NeuroTreeModels.jl/dev/" data-v-28a961f9><!--[--><!--]--><!--[--><img class="VPImage logo" src="/NeuroTreeModels.jl/dev/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-28a961f9>NeuroTreeModels</span><!--[--><!--]--></a></div></div><div class="content" data-v-40788ea0><div class="content-body" data-v-40788ea0><!--[--><!--]--><div class="VPNavBarSearch search" data-v-40788ea0><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-40788ea0 data-v-492ea56d><span id="main-nav-aria-label" class="visually-hidden" data-v-492ea56d>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/NeuroTreeModels.jl/dev/" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/NeuroTreeModels.jl/dev/quick-start" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Quick start</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/NeuroTreeModels.jl/dev/design" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Design</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/NeuroTreeModels.jl/dev/models" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>Models</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/NeuroTreeModels.jl/dev/API" tabindex="0" data-v-492ea56d data-v-ed5ac1f6><!--[--><span data-v-ed5ac1f6>API</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-492ea56d data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-e5380155><span class="text" data-v-e5380155><!----><span data-v-e5380155>Tutorials</span><span class="vpi-chevron-down text-icon" data-v-e5380155></span></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><div class="items" data-v-97491713><!--[--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/NeuroTreeModels.jl/dev/tutorials-regression-boston" data-v-8b74d055><!--[-->Regression<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/NeuroTreeModels.jl/dev/tutorials-logistic-titanic" data-v-8b74d055><!--[-->Logistic<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-97491713 data-v-8b74d055><a class="VPLink link" href="/NeuroTreeModels.jl/dev/tutorials-classification-iris" data-v-8b74d055><!--[-->Classification<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-40788ea0 data-v-ead91a81><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-ead91a81 data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-40788ea0 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Evovest/NeuroTreeModels.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-40788ea0 data-v-9b536d0b data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e5380155><span class="vpi-more-horizontal icon" data-v-e5380155></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><!----><!--[--><!--[--><!----><div class="group" data-v-9b536d0b><div class="item appearance" data-v-9b536d0b><p class="label" data-v-9b536d0b>Appearance</p><div class="appearance-action" data-v-9b536d0b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-9b536d0b data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-9b536d0b><div class="item social-links" data-v-9b536d0b><div class="VPSocialLinks social-links-list" data-v-9b536d0b data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/Evovest/NeuroTreeModels.jl" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-40788ea0 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-40788ea0><div class="divider-line" data-v-40788ea0></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-bc9dc845><button data-v-bc9dc845>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-ec846e01><div class="curtain" data-v-ec846e01></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ec846e01><span class="visually-hidden" id="sidebar-aria-label" data-v-ec846e01> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0 has-active" data-v-ec846e01 data-v-2ea20db7><!----><div class="items" data-v-2ea20db7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Home</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/quick-start" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Quick start</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/design" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Design</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/models" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/API" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>API</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-2ea20db7><div class="item" role="button" tabindex="0" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><h2 class="text" data-v-2ea20db7>Tutorials</h2><!----></div><div class="items" data-v-2ea20db7><!--[--><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/tutorials-regression-boston" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Regression</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/tutorials-logistic-titanic" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Logistic</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-2ea20db7 data-v-2ea20db7><div class="item" data-v-2ea20db7><div class="indicator" data-v-2ea20db7></div><a class="VPLink link link" href="/NeuroTreeModels.jl/dev/tutorials-classification-iris" data-v-2ea20db7><!--[--><p class="text" data-v-2ea20db7>Classification</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _NeuroTreeModels_jl_dev_design" data-v-83890dd9><div><h1 id="NeuroTree-A-differentiable-tree-operator-for-tabular-data" tabindex="-1">NeuroTree - A differentiable tree operator for tabular data <a class="header-anchor" href="#NeuroTree-A-differentiable-tree-operator-for-tabular-data" aria-label="Permalink to &quot;NeuroTree - A differentiable tree operator for tabular data {#NeuroTree-A-differentiable-tree-operator-for-tabular-data}&quot;">​</a></h1><h2 id="Overview" tabindex="-1">Overview <a class="header-anchor" href="#Overview" aria-label="Permalink to &quot;Overview {#Overview}&quot;">​</a></h2><p>This work introduces <code>NeuroTree</code> a differentiable binary tree operator adapted for the treatment of tabular data.</p><ul><li><p>Address the shortcoming of traditional trees greediness: all node and leaves are learned simultaneously. It provides the ability to learn an optimal configuration across all the tree levels. The notion extent also to the collection of trees that are simultaneously learned.</p></li><li><p>Extend the notion of forest/bagging and boosting.</p><ul><li>Although the predictions from the all the trees forming a NeuroTree operator are averaged, each of the tree prediction is tuned simultaneously. This is different from boosting (ex XGBoost) where each tree is learned sequentially and over the residual from previous trees. Also, unlike random forest and bagging, trees aren&#39;t learned in isolation but tuned collaboratively, resulting in predictions that account for all of the other tree predictions.</li></ul></li><li><p>General operator compatible for composition.</p><ul><li>Allows integration within Flux&#39;s Chain like other standard operators from NNLib. Composition is also illustrated through the built-in StackTree layer, a residual composition of multiple NeuroTree building blocks.</li></ul></li><li><p>Compatible with general purpose machine learning framework.</p><ul><li>MLJ integration</li></ul></li></ul><h2 id="Architecture" tabindex="-1">Architecture <a class="header-anchor" href="#Architecture" aria-label="Permalink to &quot;Architecture {#Architecture}&quot;">​</a></h2><p>A NeuroTree operator acts as collection of complete binary trees, ie. trees without any pruned node. To be differentiable, hence trainable using first-order gradient based methods (ex. Adam optimiser), each tree path implements a soft decision rather than a hard one like in traditional decision tree.</p><p>To introduce the implementation of a NeuroTree, we first get back to the architecture of a basic decision tree.</p><p><img src="/NeuroTreeModels.jl/dev/assets/decision-tree.Dqh78YdA.png" alt=""></p><p>The above is a binary decision tree of <code>depth</code> 2.</p><p>Highlighted in green is the decision path taken for a given sample. It goes into <code>depth</code> number of binary decisions, resulting in the path <code>node1 → node3 → leaf3</code>.</p><p>One way to view the role of the decision nodes (gray background) is to provide an index of the leaf prediction to fetch (index <code>3</code> in the figure). Such indexing view is applicable given that node routing relies on hard conditions: either <code>true</code> or <code>false</code>.</p><p>An alternative perspective that we adopt here is that tree nodes collectively provide weights associated to each leaf. A tree prediction becomes the weighted sum of the leaf&#39;s values and the leaf&#39;s weights. In regular decision trees, since all conditions are binary, leaf weights take the form of a mask. In the above example, the mask is <code>[0, 0, 1, 0]</code>.</p><p>By relaxing these hard conditions into soft ones, the mask takes the form of a probability vector associated to each leaf, where <code>∑(leaf_weights) = 1</code> and where each each <code>leaf_weight</code> element is <code>[0, 1]</code>. A tree prediction can be obtained with the dot product: <code>leaf_values&#39; * leaf_weights</code>.</p><p>The following illustrate how a basic decision tree is represented as a single differentiable tree within NeuroTree:</p><p><img src="/NeuroTreeModels.jl/dev/assets/neurotree.vCO5vhkM.png" alt=""></p><h3 id="Node-weights" tabindex="-1">Node weights <a class="header-anchor" href="#Node-weights" aria-label="Permalink to &quot;Node weights {#Node-weights}&quot;">​</a></h3><p>To illustrate how a NeuroTree derives the soft decision probability (referred to <code>NW1 - NW3</code> in the above figure), we first break down how a traditional tree split condition is derived from 2 underlying decisions:</p><ol><li><em>Selection of the feature on which to apply the condition</em>.</li></ol><p>Such selection can be represented as the application of a binary mask where all elements are set to <code>false</code> except for that single selected feature where it&#39;s set to <code>true</code>.</p><ol><li><em>Selection of the condition&#39;s threshold value</em>.</li></ol><p>For a given observation, if the selected feature&#39;s value is below that threshold, then the node decision is set to <code>false</code> (pointing to left child), and <code>true</code> otherwise (pooinnting to right child).</p><p>In NeuroTree, these 2 hard steps are translated into soft, differentiable ones.</p><h3 id="Leaf-weights" tabindex="-1">Leaf weights <a class="header-anchor" href="#Leaf-weights" aria-label="Permalink to &quot;Leaf weights {#Leaf-weights}&quot;">​</a></h3><p>Computing the leaf weights consists of accumulating the weights through each tree branch. It&#39;s the technically more challenging part as such computation cannot be represented as a form of matrix multiplication, unlike other common operators like <code>Dense</code>, <code>Conv</code> or <code>MultiHeadAttention</code> / <code>Transformer</code>. Performing probability accumulation though a tree index naturally leads to in-place element wise operations, which are notoriously not friendly for auto-differentiation engines. Since NeuroTree was intended to integrate with the Flux.jl ecosystem, Zygote.jl acts as the underlying AD, the approach used was to manually implement <code>backward</code> / <code>adjoint</code> of the terminal leaf function and instruct the AD to use that custom rule rather than attempt to differentiate a non-AD compliant function.</p><p>Below are the algo and actual implementation of the forward and backward function that compute the leaf weights. For brevity, the loops over each observation of the batch and each tree are omitted. Parallelism, both on CPU and GPU, is obtained through parallelization over the <code>tree</code> and <code>batch</code> dimensions.</p><p><strong>Forward</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> leaf_weights!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nw)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    cw </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ones</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">eltype</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nw), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nw, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cw, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cw[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cw[i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nw[i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        cw[i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, tree, batch] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cw[i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nw[i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    lw </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cw[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nw, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(cw, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (cw, lw)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><p><strong>Backward</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">function</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Δ_leaf_weights!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Δnw, ȳ, cw, nw, max_depth, node_offset)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> axes</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(nw, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)        </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        depth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> floor</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Int, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">log2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(i)) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># current depth level - starting at 0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(max_depth </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> depth) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># iteration length</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        leaf_offset </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> step </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">^</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">depth) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># offset on the leaf row</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf_offset)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(step</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">÷</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf_offset)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node_offset </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># move from leaf position to full tree position </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Δnw[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ȳ[j] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cw[k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nw[i]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        end</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf_offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">step</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">÷</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(step</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">leaf_offset)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            k </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> j </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> node_offset</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            Δnw[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ȳ[j] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cw[k] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> nw[i])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        end</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    end</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nothing</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">end</span></span></code></pre></div><h3 id="Tree-prediction" tabindex="-1">Tree prediction <a class="header-anchor" href="#Tree-prediction" aria-label="Permalink to &quot;Tree prediction {#Tree-prediction}&quot;">​</a></h3><h2 id="Composability" tabindex="-1">Composability <a class="header-anchor" href="#Composability" aria-label="Permalink to &quot;Composability {#Composability}&quot;">​</a></h2><ul><li><p>StackTree</p></li><li><p>General operator: Chain <code>NeuroTree</code> with MLP</p></li></ul><h2 id="Benchmarks" tabindex="-1">Benchmarks <a class="header-anchor" href="#Benchmarks" aria-label="Permalink to &quot;Benchmarks {#Benchmarks}&quot;">​</a></h2><p>For each dataset and algo, the following methodology is followed:</p><ul><li><p>Data is split in three parts: <code>train</code>, <code>eval</code> and <code>test</code></p></li><li><p>A random grid of 16 hyper-parameters is generated</p></li><li><p>For each parameter configuration, a model is trained on <code>train</code> data until the evaluation metric tracked against the <code>eval</code> stops improving (early stopping)</p></li><li><p>The trained model is evaluated against the <code>test</code> data</p></li><li><p>The metric presented in below are the ones obtained on the <code>test</code> for the model that generated the best <code>eval</code> metric.</p></li></ul><p>Source code available at <a href="https://github.com/Evovest/MLBenchmarks.jl" target="_blank" rel="noreferrer">MLBenchmarks.jl</a>.</p><p>For performance assessment, benchmarks is run on the following selection of common Tabular datasets:</p><ul><li><p><a href="https://archive.ics.uci.edu/dataset/203/yearpredictionmsd" target="_blank" rel="noreferrer">Year</a>: min squared error regression. 515,345 observations, 90 features.</p></li><li><p><a href="https://www.microsoft.com/en-us/research/project/mslr/" target="_blank" rel="noreferrer">MSRank</a>: ranking problem with min squared error regression. 1,200,192 observations, 136 features.</p></li><li><p><a href="https://webscope.sandbox.yahoo.com/" target="_blank" rel="noreferrer">YahooRank</a>: ranking problem with min squared error regression. 709,877 observations, 519 features.</p></li><li><p><a href="https://archive.ics.uci.edu/dataset/280/higgs" target="_blank" rel="noreferrer">Higgs</a>: 2-level classification with logistic regression. 11,000,000 observations, 28 features.</p></li><li><p><a href="https://juliaml.github.io/MLDatasets.jl/stable/datasets/misc/#MLDatasets.BostonHousing" target="_blank" rel="noreferrer">Boston Housing</a>: min squared error regression. 506 observations, 13 features.</p></li><li><p><a href="https://juliaml.github.io/MLDatasets.jl/stable/datasets/misc/#MLDatasets.Titanic" target="_blank" rel="noreferrer">Titanic</a>: 2-level classification with logistic regression. 891 observations, 7 features.</p></li></ul><p>Comparison is performed against the following algos (implementation in link) considered as state of the art on classification tasks:</p><ul><li><p><a href="https://github.com/Evovest/EvoTrees.jl" target="_blank" rel="noreferrer">EvoTrees</a></p></li><li><p><a href="https://github.com/dmlc/XGBoost.jl" target="_blank" rel="noreferrer">XGBoost</a></p></li><li><p><a href="https://github.com/IQVIA-ML/LightGBM.jl" target="_blank" rel="noreferrer">LightGBM</a></p></li><li><p><a href="https://github.com/JuliaAI/CatBoost.jl" target="_blank" rel="noreferrer">CatBoost</a></p></li><li><p><a href="https://github.com/manujosephv/pytorch_tabular" target="_blank" rel="noreferrer">NODE</a></p></li></ul><h4 id="Boston" tabindex="-1">Boston <a class="header-anchor" href="#Boston" aria-label="Permalink to &quot;Boston {#Boston}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:center;"><strong>model_type</strong></th><th style="text-align:center;"><strong>train_time</strong></th><th style="text-align:center;"><strong>mse</strong></th><th style="text-align:center;"><strong>gini</strong></th></tr></thead><tbody><tr><td style="text-align:center;">neurotrees</td><td style="text-align:center;">12.8</td><td style="text-align:center;">18.9</td><td style="text-align:center;"><strong>0.947</strong></td></tr><tr><td style="text-align:center;">evotrees</td><td style="text-align:center;">0.206</td><td style="text-align:center;">19.7</td><td style="text-align:center;">0.927</td></tr><tr><td style="text-align:center;">xgboost</td><td style="text-align:center;">0.0648</td><td style="text-align:center;">19.4</td><td style="text-align:center;">0.935</td></tr><tr><td style="text-align:center;">lightgbm</td><td style="text-align:center;">0.865</td><td style="text-align:center;">25.4</td><td style="text-align:center;">0.926</td></tr><tr><td style="text-align:center;">catboost</td><td style="text-align:center;">0.0511</td><td style="text-align:center;"><strong>13.9</strong></td><td style="text-align:center;">0.946</td></tr></tbody></table><h4 id="Titanic" tabindex="-1">Titanic <a class="header-anchor" href="#Titanic" aria-label="Permalink to &quot;Titanic {#Titanic}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:center;"><strong>model_type</strong></th><th style="text-align:center;"><strong>train_time</strong></th><th style="text-align:center;"><strong>logloss</strong></th><th style="text-align:center;"><strong>accuracy</strong></th></tr></thead><tbody><tr><td style="text-align:center;">neurotrees</td><td style="text-align:center;">7.58</td><td style="text-align:center;">0.407</td><td style="text-align:center;">0.828</td></tr><tr><td style="text-align:center;">evotrees</td><td style="text-align:center;">0.673</td><td style="text-align:center;">0.382</td><td style="text-align:center;">0.828</td></tr><tr><td style="text-align:center;">xgboost</td><td style="text-align:center;">0.0379</td><td style="text-align:center;"><strong>0.375</strong></td><td style="text-align:center;">0.821</td></tr><tr><td style="text-align:center;">lightgbm</td><td style="text-align:center;">0.615</td><td style="text-align:center;">0.390</td><td style="text-align:center;"><strong>0.836</strong></td></tr><tr><td style="text-align:center;">catboost</td><td style="text-align:center;">0.0326</td><td style="text-align:center;">0.388</td><td style="text-align:center;"><strong>0.836</strong></td></tr></tbody></table><h4 id="Year" tabindex="-1">Year <a class="header-anchor" href="#Year" aria-label="Permalink to &quot;Year {#Year}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:center;"><strong>model_type</strong></th><th style="text-align:center;"><strong>train_time</strong></th><th style="text-align:center;"><strong>mse</strong></th><th style="text-align:center;"><strong>gini</strong></th></tr></thead><tbody><tr><td style="text-align:center;">neurotrees</td><td style="text-align:center;">280.0</td><td style="text-align:center;"><strong>76.4</strong></td><td style="text-align:center;"><strong>0.652</strong></td></tr><tr><td style="text-align:center;">evotrees</td><td style="text-align:center;">18.6</td><td style="text-align:center;">80.1</td><td style="text-align:center;">0.627</td></tr><tr><td style="text-align:center;">xgboost</td><td style="text-align:center;">17.2</td><td style="text-align:center;">80.2</td><td style="text-align:center;">0.626</td></tr><tr><td style="text-align:center;">lightgbm</td><td style="text-align:center;">8.11</td><td style="text-align:center;">80.3</td><td style="text-align:center;">0.624</td></tr><tr><td style="text-align:center;">catboost</td><td style="text-align:center;">80.0</td><td style="text-align:center;">79.2</td><td style="text-align:center;">0.635</td></tr></tbody></table><h4 id="MSRank" tabindex="-1">MSRank <a class="header-anchor" href="#MSRank" aria-label="Permalink to &quot;MSRank {#MSRank}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:center;"><strong>model_type</strong></th><th style="text-align:center;"><strong>train_time</strong></th><th style="text-align:center;"><strong>mse</strong></th><th style="text-align:center;"><strong>ndcg</strong></th></tr></thead><tbody><tr><td style="text-align:center;">neurotrees</td><td style="text-align:center;">39.1</td><td style="text-align:center;">0.578</td><td style="text-align:center;">0.462</td></tr><tr><td style="text-align:center;">evotrees</td><td style="text-align:center;">37.0</td><td style="text-align:center;">0.554</td><td style="text-align:center;"><strong>0.504</strong></td></tr><tr><td style="text-align:center;">xgboost</td><td style="text-align:center;">12.5</td><td style="text-align:center;">0.554</td><td style="text-align:center;">0.503</td></tr><tr><td style="text-align:center;">lightgbm</td><td style="text-align:center;">37.5</td><td style="text-align:center;"><strong>0.553</strong></td><td style="text-align:center;">0.503</td></tr><tr><td style="text-align:center;">catboost</td><td style="text-align:center;">15.1</td><td style="text-align:center;">0.558</td><td style="text-align:center;">0.497</td></tr></tbody></table><h4 id="Yahoo" tabindex="-1">Yahoo <a class="header-anchor" href="#Yahoo" aria-label="Permalink to &quot;Yahoo {#Yahoo}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:center;"><strong>model_type</strong></th><th style="text-align:center;"><strong>train_time</strong></th><th style="text-align:center;"><strong>mse</strong></th><th style="text-align:center;"><strong>ndcg</strong></th></tr></thead><tbody><tr><td style="text-align:center;">neurotrees</td><td style="text-align:center;">417.0</td><td style="text-align:center;">0.584</td><td style="text-align:center;">0.781</td></tr><tr><td style="text-align:center;">evotrees</td><td style="text-align:center;">687.0</td><td style="text-align:center;">0.545</td><td style="text-align:center;">0.797</td></tr><tr><td style="text-align:center;">xgboost</td><td style="text-align:center;">120.0</td><td style="text-align:center;">0.547</td><td style="text-align:center;"><strong>0.798</strong></td></tr><tr><td style="text-align:center;">lightgbm</td><td style="text-align:center;">244.0</td><td style="text-align:center;"><strong>0.540</strong></td><td style="text-align:center;">0.796</td></tr><tr><td style="text-align:center;">catboost</td><td style="text-align:center;">161.0</td><td style="text-align:center;">0.561</td><td style="text-align:center;">0.794</td></tr></tbody></table><h4 id="Higgs" tabindex="-1">Higgs <a class="header-anchor" href="#Higgs" aria-label="Permalink to &quot;Higgs {#Higgs}&quot;">​</a></h4><table tabindex="0"><thead><tr><th style="text-align:center;"><strong>model_type</strong></th><th style="text-align:center;"><strong>train_time</strong></th><th style="text-align:center;"><strong>logloss</strong></th><th style="text-align:center;"><strong>accuracy</strong></th></tr></thead><tbody><tr><td style="text-align:center;">neurotrees</td><td style="text-align:center;">12300.0</td><td style="text-align:center;"><strong>0.452</strong></td><td style="text-align:center;"><strong>0.781</strong></td></tr><tr><td style="text-align:center;">evotrees</td><td style="text-align:center;">2620.0</td><td style="text-align:center;">0.464</td><td style="text-align:center;">0.776</td></tr><tr><td style="text-align:center;">xgboost</td><td style="text-align:center;">1390.0</td><td style="text-align:center;">0.462</td><td style="text-align:center;">0.776</td></tr><tr><td style="text-align:center;">lightgbm</td><td style="text-align:center;">1330.0</td><td style="text-align:center;">0.461</td><td style="text-align:center;">0.779</td></tr><tr><td style="text-align:center;">catboost</td><td style="text-align:center;">7180.0</td><td style="text-align:center;">0.464</td><td style="text-align:center;">0.775</td></tr></tbody></table><h2 id="Discussion" tabindex="-1">Discussion <a class="header-anchor" href="#Discussion" aria-label="Permalink to &quot;Discussion {#Discussion}&quot;">​</a></h2><p>NeuroTreeModels can achieve top tier performance on both small (Boston) and large (Higgs) datasets. Its performance trailed on the two ranking regression problems (MSRank and Yahoo). Although the large number of features is a distinguishing characteristic of the Yahoo dataset, the 136 features of MSRank are not materially different for the YEAR dataset (90 features), and on which NeuroTreeMoels outperform all other algos. Considering that no sparsity mechanism is present in the feature selection for the node conditions, datasets with a very large number of features may present a challenge. Substituting the default <code>tanh</code> activation with a sparsity inducing one such as <code>hardsigmoid</code> or <code>EntrOpt</code> has not resulted in improvement from the experiments.</p><p>Another potential weakness may stem from the soft nature of the decision criteria. Traditional trees can isolate the effect of a specific feature value. This can be notably meaningful in a situation where a numeric feature taking a value of 0 may carry a particular meaning (ex. missing, unknown value). Such stump the effect of a feature should be harder to pick with NeuroTree&#39;s soft condition.</p><h2 id="References" tabindex="-1">References <a class="header-anchor" href="#References" aria-label="Permalink to &quot;References {#References}&quot;">​</a></h2><ul><li><p><a href="https://arxiv.org/abs/1909.06312v2" target="_blank" rel="noreferrer">Neural Oblivious Decision Ensembles for Deep Learning on Tabular Data</a>.</p><ul><li><p><a href="https://github.com/Qwicen/node" target="_blank" rel="noreferrer">https://github.com/Qwicen/node</a></p></li><li><p><a href="https://github.com/manujosephv/pytorch_tabular" target="_blank" rel="noreferrer">https://github.com/manujosephv/pytorch_tabular</a></p></li></ul></li><li><p><a href="https://arxiv.org/abs/2010.02921" target="_blank" rel="noreferrer">Attention augmented differentiable forest for tabular data</a></p></li><li><p><a href="https://arxiv.org/abs/2307.12198" target="_blank" rel="noreferrer">NCART: Neural Classification and Regression Tree for Tabular Data</a></p></li><li><p><a href="https://arxiv.org/abs/1709.01507" target="_blank" rel="noreferrer">Squeeze-and-Excitation Networks</a></p></li><li><p><a href="https://arxiv.org/abs/1806.06988" target="_blank" rel="noreferrer">Deep Neural Decision Trees</a></p></li><li><p><a href="https://arxiv.org/abs/1603.02754" target="_blank" rel="noreferrer">XGBoost: A Scalable Tree Boosting System</a></p></li><li><p><a href="https://arxiv.org/abs/1810.11363" target="_blank" rel="noreferrer">CatBoost: gradient boosting with categorical features support</a></p></li><li><p><a href="https://papers.nips.cc/paper_files/paper/2017/hash/6449f44a102fde848669bdd9eb6b76fa-Abstract.html" target="_blank" rel="noreferrer">LightGBM: A Highly Efficient Gradient Boosting Decision Tree</a></p></li><li><p><a href="https://arxiv.org/abs/1806.06988" target="_blank" rel="noreferrer">Deep Neural Decision Trees</a></p></li><li><p><a href="https://arxiv.org/abs/1702.07360" target="_blank" rel="noreferrer">Neural Decision Trees</a></p></li></ul></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-b88cabfa><!--[--><!--]--><div class="edit-info" data-v-b88cabfa><div class="edit-link" data-v-b88cabfa><a class="VPLink link no-icon edit-link-button" href="/NeuroTreeModels.jl/dev/github.com/Evovest/NeuroTreeModels.jl/edit/main/docs/src/design" data-v-b88cabfa><!--[--><span class="vpi-square-pen edit-link-icon" data-v-b88cabfa></span> Edit this page<!--]--></a></div><!----></div><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-b88cabfa><span class="visually-hidden" id="doc-footer-aria-label" data-v-b88cabfa>Pager</span><div class="pager" data-v-b88cabfa><a class="VPLink link pager-link prev" href="/NeuroTreeModels.jl/dev/quick-start" data-v-b88cabfa><!--[--><span class="desc" data-v-b88cabfa>Previous page</span><span class="title" data-v-b88cabfa>Quick start</span><!--]--></a></div><div class="pager" data-v-b88cabfa><a class="VPLink link pager-link next" href="/NeuroTreeModels.jl/dev/models" data-v-b88cabfa><!--[--><span class="desc" data-v-b88cabfa>Next page</span><span class="title" data-v-b88cabfa>Models</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"Cxts3P5Z\",\"models.md\":\"rB-2Dq4E\",\"tutorials-classification-iris.md\":\"59UOghft\",\"tutorials-regression-boston.md\":\"TlqGF3q4\",\"quick-start.md\":\"CgEugLCA\",\"tutorials-logistic-titanic.md\":\"Dwf_T62b\",\"design.md\":\"Ce2HVKVG\",\"api.md\":\"GhQQnZ1t\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"NeuroTreeModels\",\"description\":\"Docs for NeuroTreeModels.jl\",\"base\":\"/NeuroTreeModels.jl/dev/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Quick start\",\"link\":\"/quick-start\"},{\"text\":\"Design\",\"link\":\"/design\"},{\"text\":\"Models\",\"link\":\"/models\"},{\"text\":\"API\",\"link\":\"/API\"},{\"text\":\"Tutorials\",\"items\":[{\"text\":\"Regression\",\"link\":\"/tutorials-regression-boston\"},{\"text\":\"Logistic\",\"link\":\"/tutorials-logistic-titanic\"},{\"text\":\"Classification\",\"link\":\"/tutorials-classification-iris\"}]}],\"sidebar\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Quick start\",\"link\":\"/quick-start\"},{\"text\":\"Design\",\"link\":\"/design\"},{\"text\":\"Models\",\"link\":\"/models\"},{\"text\":\"API\",\"link\":\"/API\"},{\"text\":\"Tutorials\",\"items\":[{\"text\":\"Regression\",\"link\":\"/tutorials-regression-boston\"},{\"text\":\"Logistic\",\"link\":\"/tutorials-logistic-titanic\"},{\"text\":\"Classification\",\"link\":\"/tutorials-classification-iris\"}]}],\"editLink\":{\"pattern\":\"github.com/Evovest/NeuroTreeModels.jl/edit/main/docs/src/:path\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/Evovest/NeuroTreeModels.jl\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>